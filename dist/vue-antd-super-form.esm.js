import{Input as e,InputNumber as t,Cascader as r,AutoComplete as a,Rate as o,Slider as n,Switch as i,DatePicker as s,TimePicker as c,Button as u,Select as p,Radio as l,Checkbox as d,Divider as v,Steps as f,Upload as h,Table as b,List as g,Modal as m}from"ant-design-vue";import y from"vue-antd-super-upload";var S=["click","change","blur","focus","hoverChange","keyDown","select","ok","pressEnter"];var O={input:e,inputnumber:t,textarea:e.TextArea,password:e.Password,cascader:r,autocomplete:a,rate:o,slider:n,switch:i,datepicker:s,rangepicker:s.RangePicker,monthpicker:s.MonthPicker,weekpicker:s.WeekPicker,timepicker:c,button:u,select:p,radio:l.Group,radiogroup:l.Group,radiobutton:l,checkbox:d.Group,checkboxgroup:d.Group,divider:v,steps:f,upload:h,uploaddragger:h.Dragger,sfupload:y},j=Object.prototype.toString,k=function(e){var t={},r={},a=Object.assign({},e);return Object.keys(a).forEach(function(e){var t=a[e];"[object Undefined]"!==j.call(t)&&""!==t&&("[object String]"==j.call(t)?""!==(t=t.trim())&&(r[e]=t):r[e]=t)}),Object.keys(r).map(function(e){e.includes(",")||(t[e]=r[e])}),t},F=function(e){if("[object Object]"===j.call(e))return Object.keys(e).map(function(t){return{label:e[t],value:t}});if("[object Array]"===j.call(e))return e;throw new Error("need obj or array")};function w(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===t.indexOf(a)&&(r[a]=e[a]);return r}function x(e,t,r){var a=e.type;void 0===a&&(a="defaultType");var o=function(e,t){var r=Object.assign({},e,{on:{}});return S.forEach(function(a){e.on&&e.on[a]&&(r.on[a]=function(){for(var r,o=[],n=arguments.length;n--;)o[n]=arguments[n];return(r=e.on)[a].apply(r,o.concat([t]))})}),r}(k=w(e,["type"]),t),n=a.toLocaleLowerCase(),i=O[n],s=null;switch(n){case"button":var c=o.autoSearchEvent,u=o.on;void 0===u&&(u={});var p=o.buttonType,l=o.text,d=o.style,v=k=w(o,["autoSearchEvent","on","buttonType","text","style"]);if(c)if(u.click){var f=u.click;u.click=function(e){f(e,t),c(t)}}else u.click=function(e){c(t)};s=r(i,{style:d,props:Object.assign({},{type:p},v),on:u},[l]);break;case"divider":var h=o.sfType,b=(o.text,o.style),g=o.on;void 0===g&&(g={});var m=k=w(o,["sfType","text","style","on"]);s=r(i,{style:b,on:g,props:Object.assign({},{type:h},m)});break;case"input":case"inputnumber":case"password":case"textarea":case"switch":case"slider":case"datepicker":case"rangepicker":case"monthpicker":case"weekpicker":case"timepicker":case"cascader":case"autocomplete":case"rate":var y=o.style,j=o.on;void 0===j&&(j={});var k=w(o,["style","on"]);s=r(i,{style:y,on:j,props:k});break;case"checkbox":case"radio":case"checkboxgroup":case"radiogroup":var x=o.options;void 0===x&&(x=[]);var _=o.style,E=o.on;void 0===E&&(E={});var P=k=w(o,["options","style","on"]);s=r(i,{style:_,on:E,props:Object.assign({},{options:F(x)},P)});break;case"select":case"mentions":var z=o.options;void 0===z&&(z=[]);var C=o.style,T=o.on;void 0===T&&(T={});var $=k=w(o,["options","style","on"]);s=r(i,{style:C,on:T,props:Object.assign({},$)},F(z).map(function(e){return r(i.Option,{props:{key:e.key||e.value,value:e.value}},[e.label])}));break;case"uploaddragger":case"sfupload":case"upload":var D=o.innerHTML,M=o.style,L=o.on;void 0===L&&(L={});var V=k=w(o,["innerHTML","style","on"]);s=r(i,{style:M,on:L,props:Object.assign({},V)},[D&&D()]);break;case"radiobutton":var N=o.options;void 0===N&&(N=[]);var I=o.style,A=o.on;void 0===A&&(A={});var G=k=w(o,["options","style","on"]);s=r(i.Group,{style:I,on:A,props:Object.assign({},G)},F(N).map(function(e){return r(i.Button,{props:{key:e.key||e.value,value:e.value}},[e.label])}));break;case"steps":var H=o.options;void 0===H&&(H=[]);var B=o.style,R=o.on;void 0===R&&(R={});var U=k=w(o,["options","style","on"]);s=r(i,{style:B,on:R,props:Object.assign({},U)},F(H).map(function(e){return r(i.Step,{props:Object.assign({},{key:e.key||e.title},e)})}));break;default:s=r("input",{props:{placeholder:"default element"}})}return s}var _={props:{layout:String,formLayout:Object,data:[Array,Function],_bindForm:Function,autoSearchEvent:Function},data:function(){return{form:this.$form.createForm(this)}},beforeMount:function(){var e=this.$props._bindForm;void 0===e&&(e=function(){}),e(this.form)},render:function(e){var t=this.$props,r=t.formLayout,a=t.layout;void 0===a&&(a="horizontal");var o=t.data;void 0===o&&(o=[]);var n=t.autoSearchEvent,i=this.form,s=i.getFieldDecorator,c=r||("horizontal"===a?{labelCol:{span:6},wrapperCol:{span:14}}:{});return e("a-form",{props:{form:this.form,layout:a,form:this.form}},[this._renderElement(e,c,i,s,n,this._transFuncToObj(o,i))])},methods:{_getFieldsValue:function(){var e=this.props.form.getFieldsValue();return k(e)},_transFuncToObj:function(e,t){return void 0===e&&(e={}),"[object Function]"===Object.prototype.toString.call(e)?e(t,this):e},_renderElement:function(e,t,r,a,o,n){var i=this;return void 0===n&&(n=[]),n.map(function(n,s){var c=n.visible;void 0===c&&(c=!0);var u=n.label,p=n.extra;void 0===p&&(p=null);var l=n.hasFeedback;void 0===l&&(l=!1);var d=n.formItemLayout;void 0===d&&(d={});var v=n.unbind,f=n.key;void 0===f&&(f="random_key_"+Math.random());var h=n.config;void 0===h&&(h={});var b=n.render,g=n.renderFix,m=n.bindSearch;void 0===m&&(m=!1);var y=n.type,S=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===t.indexOf(a)&&(r[a]=e[a]);return r}(n,["visible","label","extra","hasFeedback","formItemLayout","unbind","key","config","render","renderFix","bindSearch","type"]),O=null;if(!1!==c){if("br"===y)return e("br",{key:s});if("span"===y)return e("span",{key:s,props:S},[u]);if("hidden"===y)return e("a-form-item",{style:{display:"none"},props:{key:s}},[a(f,i._transFuncToObj(h,r))(x({type:"input",hidden:!0},r,e))]);if("group"===y)O=i._renderElement(e,t,r,a,o,n.children);else if(b){var j=b(r,Form.Item)||e("input",{attrs:{placeholder:"default: render need return"}});O=!0===v?j:a(f,i._transFuncToObj(h,r))(j)}else{var k=Object.assign({},{type:y},S);m&&(k.autoSearchEvent=o);var F=x(k,r,e);O="button"===y?F:a(f,i._transFuncToObj(h,r,i))(F)}return e("a-form-item",{props:Object.assign({},{label:u,key:s,extra:p,hasFeedback:l},t,d)},[g?g(O):O])}})}}};function E(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===t.indexOf(a)&&(r[a]=e[a]);return r}function P(e){return{props:Object.assign({},e.props,{pagination:{type:[Object,Boolean],default:!0},action:Function,params:Function,extraParams:[Function,Object],pageName:String,pageSizeName:String,valueMap:Function,actionError:Function,isInit:Boolean}),data:function(){return{list:[],totalData:0,currentPage:1,pageSizeData:10}},beforeMount:function(){this._vueinit(this.$props,this.$props.isInit)},render:function(t){var r=this,a=this.$props,o=a.pagination;void 0===o&&(o=!0);a.action,a.params,a.extraParams,a.pageName,a.pageSizeName,a.valueMap,a.actionError,a.isInit;var n=E(a,["pagination","action","params","extraParams","pageName","pageSizeName","valueMap","actionError","isInit"]),i=null;if(!1===o)i=!1;else{o.total,o.current,o.pageSize;var s=o.showSizeChanger;void 0===s&&(s=!0);var c=o.onChange;void 0===c&&(c=function(){return null});var u=o.showTotal;void 0===u&&(u=function(e,t){return t[0]+"-"+t[1]+" 条, 共 "+e+" 条"});var p=o.onShowSizeChange;void 0===p&&(p=function(){return null});var l=E(o,["total","current","pageSize","showSizeChanger","onChange","showTotal","onShowSizeChange"]);i=Object.assign({},{total:this.totalData||this.$props.total||0,current:this.currentPage,pageSize:this.pageSizeData,onChange:function(){for(var e,t=[],a=arguments.length;a--;)t[a]=arguments[a];(e=r)._pageChange.apply(e,t),c.apply(void 0,t)},showTotal:u,showSizeChanger:s,onShowSizeChange:function(e,t){r._pageChange(e,t),p(e,t)}},l)}return t(e,{props:Object.assign({},n,{dataSource:this.list||[],pagination:i})})},methods:{_vueinit:function(e,t){void 0===t&&(t=!1);var r=e.pagination;void 0===r&&(r=!0);var a=e.dataSource,o=e.total;void 0===o&&(o=0);var n=r.current;void 0===n&&(n=1);var i=r.pageSize;void 0===i&&(i=10),this.list=a,this.totalData=o,this.currentPage=n,this.pageSizeData=i,t&&this._loadData()},reset:function(e){void 0===e&&(e=!0),this._vueinit(this.$props,e)},refresh:function(){this._loadData()},_pageChange:function(e,t){void 0===e&&(e=1),void 0===t&&(t=10),this.currentPage=e,this.pageSizeData=t,this._loadData()},_loadData:function(){var e,t=this,r=this.$data,a=(r.currentPage,r.pageSizeData,this.$props),o=a.action,n=a.pageName;void 0===n&&(n="page");var i=a.pageSizeName;void 0===i&&(i="pageSize");var s=a.valueMap;void 0===s&&(s=function(e){return{status:e.status,dataSource:e.entry,total:e.totalRecordSize}});var c=a.actionError;void 0===c&&(c=function(e){return console.error(e)});var u=a.params;void 0===u&&(u=function(){return{}});var p=a.extraParams;void 0===p&&(p=function(){return{}});var l="[object Function]"===j.call(p)?p():p,d=Object.assign({},l,u(),((e={})[n]=this.currentPage,e[i]=this.pageSizeData,e));if(!o)throw new Error("need action filed");o(d).then(function(e){var r=s(e),a=r.dataSource,o=r.total;r.status?(t.list=a,t.totalData=o):c(e.message)})}}}}var z=P(b),C=P(g);var T,$=(T={props:{type:String,search:Object,params:Function,autoSearchEvent:Function,_bindForm:Function,table:Object,formStyle:Object,tableStyle:Object},render:function(e){var t=this.$props,r=t.type;void 0===r&&(r="table");var a=t.search,o=t.autoSearchEvent,n=t._bindForm,i=t.table,s=t.formStyle;void 0===s&&(s={});var c=t.tableStyle;void 0===c&&(c={});var u=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===t.indexOf(a)&&(r[a]=e[a]);return r}(t,["type","search","autoSearchEvent","_bindForm","table","formStyle","tableStyle"]);return e("div",null,[e("div",{style:Object.assign({},{background:"#fff",padding:"20px","border-radius":"5px","margin-bottom":"10px"},s)},[e(_,{props:Object.assign({},a,{autoSearchEvent:o,_bindForm:n})})]),e("div",{style:Object.assign({},{background:"#fff",padding:"20px","border-radius":"5px","margin-bottom":"10px"},c)},[e("table"===r?z:C,{ref:"list",props:Object.assign({},i,u)})])])},methods:{reset:function(e){void 0===e&&(e=!0),this.$refs.list.reset(e)},refresh:function(){this.$refs.list.refresh()}}},{props:Object.assign({},T.props),data:function(){return{form:null}},render:function(e){var t=this,r=Object.assign({},this.$props,{params:function(){return t._getSearchParams()},autoSearchEvent:function(){return t.reset()},_bindForm:function(e){t.form=e}});return e(T,{ref:"hoc",props:r})},methods:{reset:function(e){void 0===e&&(e=!0),this.$refs.hoc.reset(e)},refresh:function(){this.$refs.hoc.refresh()},_getSearchParams:function(){return k(this.form.getFieldsValue())}}});var D={props:Object.assign({},m.props,{footer:[Array,Function],search:[Object,Function],action:Function,extraParams:[Object,Function],actionError:Function,actionSuccess:Function}),data:function(){return{isVisible:this.$props.visible||!1,form:null}},mounted:function(){console.log(this.form)},render:function(e){var t=this,r=this.$props,a=(r.children,r.visible,r.cancel);void 0===a&&(a=function(){});var o=r.afterClose;void 0===o&&(o=function(){});var n=r.ok;void 0===n&&(n=function(e,t,r){});var i=r.footer;void 0===i&&(i=function(e,t){});var s=r.search,c=r.form;void 0===c&&(c={});var u=r.action;void 0===u&&(u=!1);r.extraParams,r.actionError,r.actionSuccess;var p=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&-1===t.indexOf(a)&&(r[a]=e[a]);return r}(r,["children","visible","cancel","afterClose","ok","footer","search","form","action","extraParams","actionError","actionSuccess"]),l=function(){return t._onCancel(a)},d=!1!==u?this.autoHandleSubmit:function(e){n(e,t.form,function(e){return t.show(e)})};return e(m,{props:Object.assign({},{visible:this.isVisible,afterClose:function(){return t._afterClose(o)},footer:"[object Array]"===j.call(i)?i:i(l,d)},p),on:{cancel:l,ok:d}},[e(_,{props:Object.assign({},{_bindForm:function(e){t.form=e}},s)})])},methods:{show:function(e,t){void 0===e&&(e=!0),this.isVisible=e,t&&t()},_onCancel:function(e){this.show(!1,e)},_afterClose:function(e){this.form&&this.form.resetFields(),e&&e()},_getSearchParams:function(){return k(this.form.getFieldsValue())},autoHandleSubmit:function(){var e=this,t=this.props,r=t.action,a=t.extraParams;void 0===a&&(a={});var o=t.actionError;void 0===o&&(o=function(e){console.log(e)});var n=t.actionSuccess;void 0===n&&(n=function(e){console.log(e)});var i=t.valueMap;void 0===i&&(i=function(e){return{status:e.status}});var s="[object Function]"===j.call(a)?a():a;r(Object.assign({},s,this._getSearchParams())).then(function(t){i(t).status?e.show(!1,function(){return n("操作成功")}):o(t.message)}).catch(function(e){o(e.message)})}}};D.info=m.info,D.success=m.success,D.error=m.error,D.warning=m.warning,D.confirm=m.confirm;var M={VueAntdSuperForm:$,Form:_,List:C,Table:z,Modal:D};var L={install:function e(t){e.installed||(e.installed=!0,Object.keys(M).forEach(function(e){t.component(e,M[e])}))}},V=null;"undefined"!=typeof window?V=window.Vue:"undefined"!=typeof global&&(V=global.Vue),V&&V.use(L);export default L;export{M as components};
